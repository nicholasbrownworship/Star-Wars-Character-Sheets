<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FFG Star Wars Character Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg-overlay: rgba(2,6,12,0.55);
  --panel: rgba(10,18,28,0.72);
  --accent:#44d7ff;
  --muted:#98a0b3;
  --glass: rgba(255,255,255,0.03);
  font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
}
html,body{height:100%;margin:0}
body{
  background: url('4107909.jpg') no-repeat center center fixed;
  background-size: cover;
  color:#e6eef8;
  min-height:100vh;
}
body::before{
  content:""; position:fixed; inset:0;
  background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.65));
  z-index:-1;
}
.app{display:grid;grid-template-columns:320px 1fr;gap:18px;height:100vh;padding:20px;align-items:start}
.panel{background:var(--panel);border-radius:12px;padding:14px;box-shadow:0 10px 40px rgba(3,10,18,0.75);border:1px solid rgba(68,215,255,0.08)}
aside.panel{height:calc(100vh - 40px);overflow:auto}
main.panel{height:calc(100vh - 40px);overflow:auto;position:relative}
.datapad{background:linear-gradient(180deg, rgba(6,24,36,0.86), rgba(8,16,28,0.6));border:1px solid rgba(68,215,255,0.06);box-shadow:0 6px 30px rgba(0,120,160,0.12);border-radius:16px;padding:18px}
header{display:flex;gap:12px;align-items:center}
header .logo{width:52px;height:52px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#8a6b44);display:flex;align-items:center;justify-content:center;font-weight:700;font-family:'Orbitron',sans-serif;color:#021;box-shadow:0 6px 18px rgba(68,215,255,0.06)}
h1{margin:0;font-size:16px}
.meta{font-size:12px;color:var(--muted)}
.character-list{margin-top:12px}
.char-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));margin-bottom:8px;cursor:pointer}
.char-item.active{outline:2px solid rgba(68,215,255,0.08)}
.editor{display:flex;flex-direction:column;gap:12px}
.row{display:flex;gap:12px}
.col{flex:1}
label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
input[type=text], input[type=number], select, textarea{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(0,0,0,0.22);color:inherit}
textarea{resize:vertical}
.stat-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-top:8px}
.stat{padding:8px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));text-align:center}
.stat input{width:56px;text-align:center;font-size:16px;background:transparent;border:0;color:inherit}
.skills{display:flex;flex-direction:column;gap:6px;max-height:400px;overflow-y:auto}
.skill{display:flex;justify-content:space-between;align-items:center;padding:6px;border-radius:8px;background:var(--glass)}
.skill input{width:40px;margin-left:8px}
.skill .skillDice{min-width:60px;display:flex;gap:4px}
.dice-dot{display:inline-block;width:14px;height:14px;border-radius:50%;border:1px solid rgba(255,255,255,0.15);cursor:pointer;vertical-align:middle;}
.dice-dot.ability{background:green;}
.dice-dot.proficiency{background:yellow;}
.dice-dot.boost{background:blue;}
.dice-dot.force{background:white; border:1px solid #ccc;}
.dice-dot.selected{box-shadow:0 0 4px #fff;}
.dice-roller{margin-top:8px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:8px}
.dice-controls{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
.dice-controls label{display:flex;flex-direction:column;align-items:center;font-size:12px}
.dice-result{background:rgba(0,0,0,0.25);padding:10px;border-radius:8px;min-height:48px;display:flex;flex-wrap:wrap;gap:2px;align-items:center}
.actions{display:flex;gap:8px;flex-wrap:wrap}
button{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:6px 10px;border-radius:8px;color:inherit;cursor:pointer}
@media print{
  body::before{display:none}
  .app{padding:0}
  aside.panel, .controls, .character-list, .actions, button, .import-input{display:none !important}
  main.panel{box-shadow:none;border:0;background:transparent;padding:0;height:auto}
  .print-sheet{display:block}
}
@media (max-width:900px){
  .app{grid-template-columns:1fr;grid-auto-rows:auto;padding:12px}
  aside.panel{height:auto}
}
.print-sheet{display:none;background:linear-gradient(180deg,#041423,#03121a);color:#e6eef8;padding:20px;border-radius:6px}
.sheet-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.sheet-header{display:flex;justify-content:space-between;align-items:center}
.sheet-section{background:rgba(255,255,255,0.03);padding:8px;border-radius:6px}
</style>
</head>
<body>
<div class="app">
  <aside class="panel datapad">
    <header>
      <div class="logo">SW</div>
      <div>
        <h1>FFG Character Tracker</h1>
        <div class="meta">Local-only · export/import JSON · printable</div>
      </div>
    </header>
    <div class="controls" style="margin-top:12px">
      <button id="newBtn">New</button>
      <button id="duplicateBtn">Duplicate</button>
      <button id="deleteBtn">Delete</button>
      <button id="exportBtn">Export</button>
      <button id="importBtn">Import</button>
      <input id="importFile" type="file" accept="application/json" style="display:none" />
    </div>
    <div class="character-list" id="charList" aria-label="Characters"></div>
    <div style="margin-top:12px;border-top:1px solid rgba(255,255,255,0.03);padding-top:12px">
      <div class="meta">Quick actions</div>
      <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
        <button id="seedBtn">Load Sample</button>
        <button id="clearAllBtn">Clear All</button>
        <button id="printBtn">Print Sheet</button>
      </div>
    </div>
  </aside>

  <main class="panel datapad">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div class="meta">Editing</div>
        <div id="charNameDisplay" style="font-size:20px">— select a character —</div>
      </div>
      <div class="actions">
        <button id="saveBtn">Save</button>
      </div>
    </div>

    <div id="editorForm" style="display:none" class="editor">
      <div class="row">
        <div class="col">
          <label>Name</label>
          <input id="name" type="text" placeholder="Character name" />
        </div>
        <div style="width:190px">
          <label>Species</label>
          <input id="species" type="text" placeholder="Human / Twi'lek" />
        </div>
        <div style="width:220px">
          <label>Career / Role</label>
          <input id="career" type="text" placeholder="Smuggler / Bounty Hunter" />
        </div>
      </div>

      <div>
        <label>Motivation / Notes</label>
        <textarea id="notes" rows="3"></textarea>
      </div>

      <div>
        <label>Characteristics</label>
        <div class="stat-grid" id="stats"></div>
      </div>

      <div style="display:flex;gap:12px">
        <div style="flex:1">
          <label>Wounds</label>
          <input id="wounds" type="number" min="0" />
        </div>
        <div style="flex:1">
          <label>Strain</label>
          <input id="strain" type="number" min="0" />
        </div>
        <div style="flex:1">
          <label>Soak</label>
          <input id="soak" type="number" min="0" />
        </div>
        <div style="flex:1">
          <label>Defense</label>
          <input id="defense" type="number" min="0" />
        </div>
      </div>

      <div>
        <label>Gear / Equipment</label>
        <input id="gear" type="text" placeholder="Blaster, Lightsaber, Armor..." />
      </div>

      <div>
        <label>Skills</label>
        <div class="skills" id="skillList"></div>
      </div>

      <div class="dice-roller">
        <label>Dice Roller</label>
        <div class="dice-controls">
          <label>Ability <input type="number" min="0" id="diceAbility"></label>
          <label>Proficiency <input type="number" min="0" id="diceProficiency"></label>
          <label>Boost <input type="number" min="0" id="diceBoost"></label>
          <label>Force <input type="number" min="0" id="diceForce"></label>
        </div>
        <div style="margin-top:6px">
          <button id="rollDiceBtn">Roll</button>
          <button id="clearDiceBtn">Clear</button>
        </div>
        <div class="dice-result" id="diceResult"></div>
      </div>
    </div>
  </main>
</div>

<div class="print-sheet">
  <div class="sheet-header">
    <h2 id="printName"></h2>
  </div>
  <div class="sheet-grid">
    <div class="sheet-section" id="sheetStats"></div>
    <div class="sheet-section" id="sheetSkills"></div>
  </div>
</div>

<script>
// --- Constants ---
const ALL_SKILLS=[
"Astrogation","Athletics","Brawl","Computers","Coordination","Cool","Deception","Discipline",
"Leadership","Mechanics","Medicine","Negotiation","Perception","Piloting (Planetary)","Piloting (Space)",
"Resilience","Skulduggery","Stealth","Streetwise","Survival","Vigilance","Lightsaber"
];

const SKILL_ATTRIBUTES={
  "Brawl":"Brawn","Athletics":"Brawn","Melee":"Brawn",
  "Piloting (Planetary)":"Agility","Piloting (Space)":"Agility","Stealth":"Agility","Coordination":"Agility",
  "Computers":"Intellect","Mechanics":"Intellect","Medicine":"Intellect","Knowledge":"Intellect","Perception":"Intellect",
  "Deception":"Cunning","Skulduggery":"Cunning","Negotiation":"Cunning","Streetwise":"Cunning","Survival":"Cunning",
  "Willpower":"Willpower","Cool":"Willpower","Discipline":"Willpower",
  "Leadership":"Presence","Vigilance":"Presence","Lightsaber":"Brawn"
};

const diceFaces={
ability:["dice/green_blank.jpg","dice/green_success.jpg","dice/green_success_success.jpg","dice/green_success_adv.jpg","dice/green_advantage.jpg","dice/green_advantage_advantage.jpg"],
proficiency:["dice/yellow_blank.jpg","dice/yellow_success.jpg","dice/yellow_success_adv.jpg","dice/yellow_success_adv.jpg","dice/yellow_success_success.jpg","dice/yellow_success_success.jpg","dice/yellow_advantage.jpg","dice/yellow_advantage.jpg","dice/yellow_triumph.jpg"],
boost:["dice/blue_blank.jpg","dice/blue_blank.jpg","dice/blue_success.jpg","dice/blue_success_adv.jpg","dice/blue_advantage.jpg","dice/blue_advantage_advantage.jpg"],
force:["dice/white_dark.jpg","dice/white_dark.jpg","dice/white_light.jpg","dice/white_light_light.jpg"]
};

// --- Characters ---
let characters=[],selectedIndex=null;

// --- Storage ---
function saveToStorage(){localStorage.setItem("ffgChars",JSON.stringify(characters))}
function loadFromStorage(){const d=localStorage.getItem("ffgChars"); if(d) characters=JSON.parse(d)}
function refreshCharList(){
  const list=document.getElementById("charList");
  list.innerHTML="";
  characters.forEach((c,i)=>{
    const div=document.createElement("div");
    div.className="char-item"+(i===selectedIndex?" active":"");
    div.textContent=c.name;
    div.onclick=()=>openCharacter(i);
    list.appendChild(div);
  });
}

// --- Open Character ---
function openCharacter(index){
  selectedIndex=index;
  const c=characters[index];
  document.getElementById("editorForm").style.display="block";
  document.getElementById("charNameDisplay").textContent=c.name;
  document.getElementById("name").value=c.name||"";
  document.getElementById("species").value=c.species||"";
  document.getElementById("career").value=c.career||"";
  document.getElementById("notes").value=c.notes||"";
  document.getElementById("wounds").value=c.wounds||0;
  document.getElementById("strain").value=c.strain||0;
  document.getElementById("soak").value=c.soak||0;
  document.getElementById("defense").value=c.defense||0;
  document.getElementById("gear").value=c.gear||"";
  renderStats(c);
  renderSkills(c);
  refreshCharList();
}

// --- Render Stats ---
function renderStats(c){
  const stats=["Brawn","Agility","Intellect","Cunning","Willpower","Presence"];
  const container=document.getElementById("stats");
  container.innerHTML="";
  stats.forEach(s=>{
    const div=document.createElement("div");
    div.className="stat";
    div.innerHTML=`<div>${s}</div><input type="number" value="${c[s]||0}" min="0" data-stat="${s}">`;
    container.appendChild(div);
  });
  container.querySelectorAll("input").forEach(input=>{
    input.oninput=()=>{c[input.dataset.stat]=parseInt(input.value)||0; saveToStorage();}
  });
}

// --- Render Skills ---
function renderSkills(c){
  const container=document.getElementById("skillList");
  container.innerHTML="";
  ALL_SKILLS.forEach(skill=>{
    const skillDiv=document.createElement("div");
    skillDiv.className="skill";
    const attr=SKILL_ATTRIBUTES[skill]||"";
    const attrVal=c[attr]||0;
    const skillVal=c[skill]||0;

    const left=document.createElement("span");
    left.textContent=skill;

    const right=document.createElement("span");
    right.className="skillDice";

    const skillInput=document.createElement("input");
    skillInput.type="number";
    skillInput.min=0;
    skillInput.value=skillVal;
    skillInput.dataset.skill=skill;
    skillInput.oninput=()=>{
      c[skill]=parseInt(skillInput.value)||0;
      renderSkills(c);
      saveToStorage();
    };

    // --- Dice logic ---
    const totalDice=Math.max(attrVal,skillVal);
    const proficiencyUpgrades=Math.min(attrVal,skillVal);

    for(let i=0;i<totalDice;i++){
      const dot=document.createElement("span");
      if(i<proficiencyUpgrades){
        dot.className="dice-dot proficiency";
      }else{
        dot.className="dice-dot ability";
      }
      right.appendChild(dot);
    }

    skillDiv.appendChild(left);
    skillDiv.appendChild(right);
    skillDiv.appendChild(skillInput);
    container.appendChild(skillDiv);
  });
}

<script>
// --- Dice Roller with Results ---

// Define FFG dice faces mapping for calculation
const diceValues = {
  ability: [
    {success:0, advantage:0},   // blank
    {success:1, advantage:0},   // success
    {success:2, advantage:0},   // success success
    {success:1, advantage:1},   // success+advantage
    {success:0, advantage:1},   // advantage
    {success:0, advantage:2}    // advantage advantage
  ],
  proficiency: [
    {success:0, advantage:0, triumph:0}, // blank
    {success:1, advantage:0, triumph:0}, // success
    {success:1, advantage:1, triumph:0}, // success+adv
    {success:2, advantage:0, triumph:0}, // success success
    {success:2, advantage:0, triumph:0}, // success success duplicate
    {success:0, advantage:2, triumph:0}, // adv adv
    {success:0, advantage:1, triumph:0}, // adv
    {success:1, advantage:1, triumph:0}, // success+adv duplicate
    {success:1, advantage:0, triumph:1}  // triumph
  ],
  boost: [
    {success:0, advantage:0},  // blank
    {success:0, advantage:0},  // blank
    {success:1, advantage:0},  // success
    {success:1, advantage:1},  // success+adv
    {success:0, advantage:1},  // adv
    {success:0, advantage:2}   // adv adv
  ],
  force: [
    {dark:1, light:0},  // dark
    {dark:1, light:0},  // dark
    {dark:0, light:1},  // light
    {dark:0, light:2}   // light light
  ]
};

document.getElementById("rollDiceBtn").onclick = () => {
    const ability = parseInt(document.getElementById("diceAbility").value) || 0;
    const proficiency = parseInt(document.getElementById("diceProficiency").value) || 0;
    const boost = parseInt(document.getElementById("diceBoost").value) || 0;
    const force = parseInt(document.getElementById("diceForce").value) || 0;
    const container = document.getElementById("diceResult");
    container.innerHTML = "";

    // Totals
    const totals = {success:0, advantage:0, triumph:0, dark:0, light:0};

    function rollDice(diceArray, diceValueArray, count) {
        for (let i = 0; i < count; i++) {
            const img = document.createElement("img");
            const faceIndex = Math.floor(Math.random() * diceArray.length);
            img.src = diceArray[faceIndex];
            img.style.width = "24px";
            img.style.height = "24px";
            img.style.marginRight = "2px";
            container.appendChild(img);

            // Add values
            const val = diceValueArray[faceIndex];
            if(val.success) totals.success += val.success;
            if(val.advantage) totals.advantage += val.advantage;
            if(val.triumph) totals.triumph += val.triumph;
            if(val.dark) totals.dark += val.dark;
            if(val.light) totals.light += val.light;
        }
    }

    rollDice(diceFaces.ability, diceValues.ability, ability);
    rollDice(diceFaces.proficiency, diceValues.proficiency, proficiency);
    rollDice(diceFaces.boost, diceValues.boost, boost);
    rollDice(diceFaces.force, diceValues.force, force);

    // Show totals
    const resultDiv = document.createElement("div");
    resultDiv.style.marginTop = "8px";
    resultDiv.innerHTML = `
      <strong>Results:</strong> 
      Success: ${totals.success}, 
      Advantage: ${totals.advantage}, 
      Triumph: ${totals.triumph}, 
      Light: ${totals.light}, 
      Dark: ${totals.dark}
    `;
    container.appendChild(resultDiv);
};

document.getElementById("clearDiceBtn").onclick = () => {
    document.getElementById("diceResult").innerHTML = "";
};
</script>


// --- Load ---
loadFromStorage();
refreshCharList();
</script>
</body>
</html>
